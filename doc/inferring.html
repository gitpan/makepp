<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
  <head>
    <title>Automatically Inferring Object Files</title> 
  </head>

  <body>
    <h1>Automaticaly Inferring Object Files</h1>

    <p>If you use standard conventions regarding header file names,
    <i>makepp</i> is capable of guessing which <code>.o</code> or
    <code>.lo</code> files need to be linked with your program.  I use
    this to pick out files from a library directory which contains
    modules used in many different programs.  Instead of making a
    library <code>.a</code> file and having the linker pick out the
    relevant modules, <i>makepp</i> can pick out the relevant modules
    for you.  This way, only the relevant modules get compiled.</p>

    <p><i>Makepp</i>'s algorithm for inferring object dependencies
    depends on the convention that the implementation of all classes or
    functions defined in a header file <code>xyz.h</code> are compiled
    into an object file called <code>xyz.o</code> (or
    <code>xyz.lo</code>).  So <i>makepp</i>'s algorithm for inferring
    object dependencies starts with one or a few objects that we know
    have to be linked into the program.  It looks at which files were
    included with <code>#include</code> in those sources, and tries to
    find corresponding object files for each of the include files.</p>


    <p>To use this, apply the <code>$(infer_objects&nbsp;)</code>
    function to the dependency list, like this:</p>

<pre>
myprog: $(infer_objects main.o another_object.o, \
		**/*.o /other/library/dirs/**/*.o)
	$(CXX) $(<a href="syntax_makefile.html#var_inputs">inputs</a>) -o $(<a href="syntax_makefile.html#var_output">output</a>) $(LIBS)
</pre>

    <p>The <code>infer_objects</code> function takes two arguments
    (separated by a comma, as shown).  The first is one or a few object
    files that are known to be required (wildcards are permissible
    here).  The second is a list of possible objects (normally you would
    use a wildcard here) that could be linked in if necessary.  The
    return value from this function is a list that contains first all of
    the objects in the first argument, and then after those, all
    additional objects that were contained in the second argument that
    are required by the objects in the first argument.</p>

    <p>For example, suppose <code>main.o</code> comes from
    <code>main.cpp</code>, which includes <code>my_class.h</code>.
    <code>infer_objects</code> looks for files with the name
    <code>my_class.o</code>.  If exactly one such file is found, it is
    added to the list.  (If two object files <code>my_class.o</code> are
    found in different directories, a warning message is printed.)
    <code>infer_objects</code> also examines <code>my_class.cpp</code>
    to see what it includes, and what additional object files are
    implied.</p>

    <p>Since you can <a href="extending_makepp.html">write
    your own functions in perl</a>, you can encode your own algorithms
    to infer additional objects; other more sophisticated algorithms are
    possible for C++, and different algorithms will be needed for other
    languages.</p>

    <hr>
    <a href="index.html">Table of contents</a>
    |
    <a href="build_algorithm.html">Next (build algorithm)</a>
    |
    <a href="scanning.html">Previous (scanning for inculdes)</a>
    <br>
<!-- Created: Wed Aug  9 18:07:22 PDT 2000 -->
<!-- hhmts start -->
Last modified: Tue Dec 26 19:06:30 PST 2000
<!-- hhmts end -->
  </body>
</html>
